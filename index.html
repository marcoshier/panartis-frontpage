<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/ScrollTrigger.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/Flip.min.js"></script>
    <link href="/style.css" rel="stylesheet">
    <title>Panartis - Front Page</title>
</head>

<body>

    <!--HEADER-->

    <div class="header">
        <div class="logo">
            <img src="/img/Logo.svg" class="logo" />
        </div>

        <div class="hamburger">
            <img src="/img/Hamburger.svg" class="hamburger" />
        </div>
    </div>

    <header class="phantom">
        <div class="logo hidden">
            <img src="/img/Logo.svg" class="logo" />
        </div>
        <div id="hamburger" class="hamburger hidden">
            <img src="/img/Hamburger.svg" class="hamburger" />
        </div>
    </header>


    <div id="content-wrapper">

        <div id="slogan">
            <h1 class="slogan-text">
                Revolutionizing art and collectibles research by providing information, insight, and collaboration.
            </h1>
        </div>


        <div id="search-box">
            <div class="phantom-box">
                <img class="lens" src="img/Search_icon.svg" />

                <div class="inner-wrapper">

                    <div class="input-cnt">
                        <input type="search" required/>
                        <span class="placeholder">Research any object</span>
                    </div>


                    <div class="domain-cnt" onmouseleave="domainsOff()">
                        <div class="domain pill humanities humanities-pill" onmouseover="domainOn(event, this)" onclick="pillClicked(this)">
                            <!-- TODO check class name conflict-->
                            <img class="pin" src="img/pin-icon.svg" />
                            <span><i>in</i> Humanities</span>
                            <img class="dd" src="img/Dropdown_Arrow.svg" />
                        </div>
                        <div class="domain pill science science-pill" onmouseover="domainOn(event, this)" onclick="pillClicked(this)">
                            <img class="pin" src="img/pin-icon.svg" />
                            <span><i>in</i> Science</span>
                            <img class="dd" src="img/Dropdown_Arrow.svg" />
                        </div>
                        <div class="domain pill markets markets-pill" onmouseover="domainOn(event, this)" onclick="pillClicked(this)">
                            <img class="pin" src="img/pin-icon.svg" />
                            <span><i>in</i> Markets</span>
                            <img class="dd" src="img/Dropdown_Arrow.svg" />
                        </div>
                    </div>

                </div>
                <div class="filters-btn">
                    <p>FILTERS</p>
                    <img src="img/Filters_icon.svg" />
                </div>
            </div>
            <div id="subdomains-cnt" onmouseover="subdomainsOn()" onmouseleave="subdomainsOff()">
                <div class="subdomains-section humanities">
                    <div class="subdomains-cnt-img"></div>
                    <div class="subdomains-cnt-desc">
                        <p>A short description of what the domain is about can fit here.</p>
                    </div>
                    <ul class="subdomains">
                        <li class="subdomain">
                            <input id="checkbox1" type="checkbox" />
                            <label for="checkbox1">Subdomain</label>
                        </li>
                        <li class="subdomain">
                            <input id="checkbox2" type="checkbox" />
                            <label for="checkbox2">Subdomain</label>
                        </li>
                        <li class="subdomain">
                            <input id="checkbox3" type="checkbox" />
                            <label for="checkbox3">Subdomain</label>
                        </li>
                        <li class="subdomain">
                            <input id="checkbox4" type="checkbox" />
                            <label for="checkbox4">Subdomain</label>
                        </li>
                        <li class="subdomain">
                            <input id="checkbox5" type="checkbox" />
                            <label for="checkbox5">Subdomain</label>
                        </li>
                    </ul>
                    <div class="options">
                        <a href="#">SELECT ALL</a>
                        <a class="save" href="#">SAVE</a>

                        <a class="deactivate" href="#">DEACTIVATE</a>
                    </div>
                </div>
                <div class="subdomains-section science">
                    <div class="subdomains-cnt-img"></div>
                    <div class="subdomains-cnt-desc">
                        <p>A short description of what the domain is about can fit here.</p>
                    </div>

                    <ul class="subdomains">
                        <li class="subdomain">
                            <input id="checkbox1" type="checkbox" />
                            <label for="checkbox1">Subdomain</label>
                        </li>
                        <li class="subdomain">
                            <input id="checkbox2" type="checkbox" />
                            <label for="checkbox2">Subdomain</label>
                        </li>
                        <li class="subdomain">
                            <input id="checkbox3" type="checkbox" />
                            <label for="checkbox3">Subdomain</label>
                        </li>
                        <li class="subdomain">
                            <input id="checkbox4" type="checkbox" />
                            <label for="checkbox4">Subdomain</label>
                        </li>
                        <li class="subdomain">
                            <input id="checkbox5" type="checkbox" />
                            <label for="checkbox5">Subdomain</label>
                        </li>
                    </ul>
                    <div class="options">
                        <a href="#">SELECT ALL</a>
                        <a class="save" href="#">SAVE</a>

                        <a class="deactivate" href="#">DEACTIVATE</a>
                    </div>
                </div>
                <div class="subdomains-section markets">
                    <div class="subdomains-cnt-img"></div>
                    <div class="subdomains-cnt-desc">
                        <p>A short description of what the domain is about can fit here.</p>
                    </div>

                    <ul class="subdomains">
                        <li class="subdomain">
                            <input id="checkbox1" type="checkbox" />
                            <label for="checkbox1">Subdomain</label>
                        </li>
                        <li class="subdomain">
                            <input id="checkbox2" type="checkbox" />
                            <label for="checkbox2">Subdomain</label>
                        </li>
                        <li class="subdomain">
                            <input id="checkbox3" type="checkbox" />
                            <label for="checkbox3">Subdomain</label>
                        </li>
                        <li class="subdomain">
                            <input id="checkbox4" type="checkbox" />
                            <label for="checkbox4">Subdomain</label>
                        </li>
                        <li class="subdomain">
                            <input id="checkbox5" type="checkbox" />
                            <label for="checkbox5">Subdomain</label>
                        </li>
                    </ul>
                    <div class="options">
                        <a href="#">SELECT ALL</a>
                        <a class="save" href="#">SAVE</a>

                        <a class="deactivate" href="#">DEACTIVATE</a>
                    </div>
                </div>
            </div>
        </div>



        <!--PERSONAL SPACE-->

        <div id="personal-space-cnt">
            <h3>MY PERSONAL SPACE</h3>
            <div id="carousel">
                <div class="carousel-text">
                    <h1>Catalogues are central to the platform. You can for instance create a catalogue raisonné, exhibits, etc.</h1>
                </div>
                <div id="carousel-image" class="carousel-image">

                </div>

            </div>
            <div id="objects-cnt">
                <div class="object-category">
                    <div class="category-header">
                        <p>NO CATALOGUES YET</p>
                        <a>ADD A CATALOGUE+</a>
                    </div>
                    <div class="empty-category-text"><b>WHAT ARE CATALOGUES?</b> <br /><br />CATALOGUES are central to the PANARTIS platform. You can for instance create a catalogue raisonné, exhibits, and discuss about it. Decide where you share it, with peers only, or to the wider
                        art world. </div>
                    <input class="getstarted" type="button" value="GET STARTED" />
                </div>
                <div class="object-category">
                    <div class="category-header">
                        <p>NO GROUPS YET </p>
                        <a>ADD A GROUP +</a>
                    </div>
                    <div class="empty-category-text"><b>WHAT CAN YOU DO IN GROUPS?</b> <br /><br />GROUPS permits professionals to interact within controlled- access workspaces,you can create catalogue raisonné, exhibits, and joint research projects. </div>
                    <input class="getstarted" type="button" value="GET STARTED" />
                </div>
                <div class="object-category">
                    <div class="category-header">
                        <p>NO ORGANIZATIONS YET</p>
                        <a>ADD AN ORGANIZATION+</a>
                    </div>
                    <div class="empty-category-text"><b>WHAT CAN YOU DO IN ORGANIZATIONS?</b> <br /><br />ORGANIZATIONS lets dealer consortia and musea share information, more text to explain what you can do here. </div>
                    <input class="getstarted" type="button" value="GET STARTED" />
                </div>
                <div class="object-category">
                    <div class="category-header">
                        <p>NO NEWS YET</p>
                        <a>ADD A NEWS ITEM+</a>
                    </div>
                    <div class="empty-category-text"><b>WHAT IS NEWS?</b> <br /><br />CATALOGUES are central to the PANARTIS platform. You can for instance create a catalogue raisonné, exhibits, and discuss about it. Decide where you share it, with peers only, or to the wider art world.
                    </div>
                    <input class="getstarted" type="button" value="GET STARTED" />
                </div>
                <div class="object-category">
                    <div class="category-header">
                        <p>NO EXHIBITIONS YET </p>
                        <a>ADD AN EXHIBITION +</a>
                    </div>
                    <div class="empty-category-text"><b>WHAT CAN YOU DO IN EXHIBITIONS?</b> <br /><br />GROUPS permits professionals to interact within controlled- access workspaces,you can create catalogue raisonné, exhibits, and joint research projects </div>
                    <input class="getstarted" type="button" value="GET STARTED" />
                </div>
                <div class="object-category">
                    <div class="category-header">
                        <p>NO MEDIA YET</p>
                        <a>ADD MEDIA +</a>
                    </div>
                    <div class="empty-category-text"><b>WHAT CAN YOU DO IN MEDIA? </b> <br /><br /> ORGANIZATIONS lets dealer consortia and musea share information, more text to explain what you can do here. </div>
                    <input class="getstarted" type="button" value="GET STARTED" />
                </div>
            </div>
        </div>
    </div>


</body>
<script type="text/javascript">
    let subdomainIsOn = false,
        domainIsOn = true,
        debounce = 100,
        pillsCnt = document.querySelector(".domain-cnt"),
        pills = Array.from(document.querySelectorAll(".domain")),
        subdomainCnt = document.getElementById("subdomains-cnt"),
        subSections = Array.from(document.querySelectorAll(".subdomains-section")),

        searchBox = document.getElementById("search-box"),
        contentWrapper = document.getElementById("content-wrapper"),
        header = document.querySelector("header"),
        pinnedPill = null;


    let pillClicked = (element) => {

        console.log(element.querySelector(".pin").classList)
        if (!element.querySelector(".pin").classList.contains("pinned")) {
            element.querySelector(".pin").classList.add("pinned");
            pills.filter(pill => pill != element && !pill.querySelector(".pin").classList.contains("pinned")).forEach(greypill =>
                greypill.classList.add("greyedout")
            );
        } else if (element.querySelector(".pin").classList.contains("pinned")) {
            element.querySelector(".pin").classList.remove("pinned");
            // pills.filter(pill => pill != element).forEach(greypill =>
            //     greypill.classList.remove("greyedout")
            // );
        }



        if (pinnedPill == null) {
            pinnedPill = element
        } else {
            pinnedPill = null
        }
    }

    let moveSubdomains = (distance) => {

    }

    let colorPill = (color, i) => {
        subdomainCnt.style.backgroundColor = color
        let subdomainCntWidth = subdomainCnt.getBoundingClientRect().width
        let distance = i * subdomainCntWidth

        subSections.forEach(subsection => {
            gsap.to(subsection, {
                duration: 0.5,
                ease: "power4.inOut",
                x: -distance
            })
        })


    }

    let expandPill = (event, el) => {


        el.classList.remove("greyedout");
        pills.filter(pill => pill != el && !pill.querySelector(".pin").classList.contains("pinned")).forEach(greypill =>
            greypill.classList.add("greyedout")


        );

        if (subdomainIsOn == false) {
            subdomainCnt.classList.add("expanded")
        }

        //el.querySelector("img").classList.add("pin");

        if (el.classList.contains("humanities")) {
            colorPill("#F5E3A6", 0);
        } else if (el.classList.contains("science")) {
            colorPill("#96EFAA", 1);
        } else if (el.classList.contains("markets")) {
            colorPill("#F4B5B1", 2);
        }
    }

    let collapse = () => {

        pills.filter(pill => !pill.querySelector(".pin").classList.contains("pinned")).forEach(pill => {
            if (pill.classList.contains("greyedout")) {
                pill.classList.remove("greyedout")
            }
        })

        setTimeout(() => {
            subdomainCnt.classList.remove("expanded")

        }, 500);

    }

    let domainOn = (e, el) => {
        e.stopPropagation()
        let element = el

        domainIsOn = true;

        if (element != undefined) {
            expandPill(e, element);
        }
    }

    let domainsOff = () => {
        domainIsOn = false;

        setTimeout(() => {

                if (subdomainIsOn == false) {
                    // IF ALSO SUBDOMAIN IS NOT HOVERED THEN COLLAPSE EVERYTHING
                    // TODO COLLAPSE
                    collapse();
                }
            }, debounce)
            // DOMAIN IS NOT HOVERED

    }

    let subdomainsOn = () => {
        subdomainIsOn = true;
    }

    let subdomainsOff = () => {
        subdomainIsOn = false;


        setTimeout(() => {
            if (domainIsOn == false) {
                collapse();
            } else {
                // LISTEN FOR NEWLY HOVERED PILL
            }
        }, debounce);

    }

    gsap.registerPlugin(ScrollTrigger);
    gsap.registerPlugin(Flip)

    let triggered = false,
        minimized = false

    let searchBoxAnimation = (reverse) => {

        if (triggered == false && reverse == false) {

            triggered = true

            let state = Flip.getState(searchBox);
            let parent = searchBox.parentNode === contentWrapper ? header : contentWrapper
            let child = document.getElementById("hamburger")

            if (parent.contains(child)) {
                parent.insertBefore(searchBox, child);


                Flip.from(state, {
                    duration: 0.55,
                    ease: "power4.inOut",
                    scale: true,
                    onComplete: () => {
                        minimized = true;
                        triggered = false;

                    }
                })

                gsap.to(".phantom-box", {
                    duration: 0.55,
                    ease: "power4.inOut",
                    height: "41px",
                    border: "1px solid #2f2f2f30"
                }, 0);
                gsap.to(".placeholder", {
                    duration: 0.55,
                    ease: "power4.inOut",
                    lineHeight: "41px",
                    fontSize: "18px"
                }, 0)
                gsap.to(".domain", {
                    duration: 0.55,
                    ease: "power4.inOut",
                    height: "37px",
                    margin: "2px 3px !important"
                }, 0);
                gsap.to(".filters-btn", {
                    duration: 0.55,
                    ease: "power4.inOut",
                    height: "37px"
                }, 0);
                gsap.to(".domain span", {
                    duration: 0.55,
                    ease: "power4.inOut",
                    lineHeight: "41px"
                }, 0);
            }
        } else if (triggered == false && reverse == true) {
            triggered = true


            let parent = (searchBox.parentNode === contentWrapper ? header : contentWrapper)
            let child = document.getElementById("personal-space-cnt")

            if (parent.contains(child)) {
                let state = Flip.getState(searchBox);
                parent.insertBefore(searchBox, child);

                Flip.from(state, {
                    duration: 0.55,
                    ease: "power4.inOut",
                    scale: false,
                    onComplete: () => {
                        minimized = false, triggered = false
                    }
                })


                gsap.to(".phantom-box", {
                    duration: 0.55,
                    ease: "power4.inOut",
                    height: "54px",
                    border: "1px solid #2f2f2f00"
                }, 0);
                gsap.to(".placeholder", {
                    duration: 0.55,
                    ease: "power4.inOut",
                    lineHeight: "54px",
                    fontSize: "23px"
                }, 0);
                gsap.to(".domain", {
                    duration: 0.55,
                    ease: "power4.inOut",
                    height: "46px",
                    margin: "4px 2px !important"
                }, 0);
                gsap.to(".filters-btn", {
                    duration: 0.55,
                    ease: "power4.inOut",
                    height: "46px"
                }, 0);
                gsap.to(".domain span", {
                    duration: 0.55,
                    ease: "power4.inOut",
                    lineHeight: "46px"
                }, 0);
            }


        }



    }

    let imageAnimation = () => {
        gsap.to("#carousel-image", {
            scrollTrigger: {
                trigger: "#carousel-image",
                start: "top bottom",
                end: "bottom center",
                scrub: 1
            },
            scale: 1.0,
            y: 0,
            ease: "power4.inOut",
            duration: 3.8
        })
    }

    let initAnimations = () => {

        document.addEventListener("wheel", (e) => {

            e.stopPropagation()
            if (document.body.scrollTop >= 200 && minimized == false) {
                searchBoxAnimation(false);
            } else if (document.body.scrollTop < 200 && document.body.scrollTop >= 0 && minimized == true) {
                searchBoxAnimation(true);
            }
        });
        imageAnimation();
    }

    initAnimations();
</script>

</html>